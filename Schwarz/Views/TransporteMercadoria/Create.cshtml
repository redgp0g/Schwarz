@model Schwarz.Models.TransporteMercadoria
@using Microsoft.AspNetCore.Identity
@using Schwarz.Areas.Identity.Data


@inject UserManager<SchwarzUser> UserManager

@{
    ViewData["Title"] = "Registrar";
    Layout = "_Layout";
}
<div class="container mx-auto">
    <div class="flex justify-center px-6 my-12">
        <div class="w-full xl:w-3/4 lg:w-11/12 flex">
            <div class="w-full bg-white p-2 rounded-lg lg:rounded-l-none">
                <h3 class="pt-4 text-2xl text-center">Relatório de Transporte de Mercadorias</h3>
                <form id="formTransporteMercadoria" asp-action="Create" method="post" class="px-8 bg-white rounded" enctype="multipart/form-data">
                    <div class="mb-4">
                        <label asp-for="NotaFiscal" class="block mb-2 text-sm font-bold"></label>
                        <input asp-for="NotaFiscal" class="w-full px-3 py-2 text-sm leading-tight text-gray-700 border rounded shadow appearance-none focus:outline-none focus:shadow-outline" autocomplete="off" placeholder="Nota Fiscal" />
                        @Html.ValidationMessageFor(x => x.NotaFiscal)
                    </div>
                    <div class="mb-4">
                        <label asp-for="Volume" class="block text-sm font-medium leading-6 text-gray-900">Volume</label>
                        <div class="relative mt-2 rounded-md shadow-sm">
                            <input asp-for="Volume" class="block w-full rounded-md border-0 py-1.5 pl-3 pr-20 text-gray-900 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6" placeholder="Quantidade de volumes">
                            <div class="absolute inset-y-0 right-0 flex items-center">
                                <label asp-for="TipoVolume" class="sr-only">Tipo de Volume</label>
                                <select asp-for="TipoVolume" class="h-full rounded-md border-0 bg-transparent py-0 pl-2 pr-7 text-gray-500 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm">
                                    <option value="" disabled selected>Selecione o Tipo</option>
                                    <option value="Caixa">Caixa</option>
                                    <option value="Pallet">Pallet</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="mb-4">
                        <label asp-for="Transportadora" class="block mb-2 text-sm font-bold"></label>
                        <input asp-for="Transportadora" class="w-full px-3 py-2 text-sm leading-tight text-gray-700 border rounded shadow appearance-none focus:outline-none focus:shadow-outline" autocomplete="off" placeholder="Transportadora" />
                        @Html.ValidationMessageFor(x => x.Transportadora)
                    </div>
                    <div class="mb-4">
                        <label asp-for="Placa" class="block mb-2 text-sm font-bold"></label>
                        <input asp-for="Placa" class="w-full px-3 py-2 text-sm leading-tight text-gray-700 border rounded shadow appearance-none focus:outline-none focus:shadow-outline" autocomplete="off" placeholder="Placa" />
                        @Html.ValidationMessageFor(x => x.Placa)
                    </div>
                    <div class="mb-4">
                        <label asp-for="IDCliente" class="block mb-2 text-sm font-bold flex items-center"></label>
                        <div class="relative mt-2 rounded-md shadow-sm">
                            <select asp-for="IDCliente" class="block w-full rounded-md border-0 py-1.5 pl-3 pr-20 text-gray-600 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6" asp-items="ViewBag.Clientes">
                                <option selected disabled value="">Selecione o Cliente</option>
                            </select>
                        </div>
                        @Html.ValidationMessageFor(x => x.IDCliente)
                    </div>
                    <div class="mb-4">
                        <label asp-for="fileFotoLacre" class="block mb-2 text-sm font-bold flex items-center"></label>
                        <input asp-for="fileFotoLacre" accept="image/*" />
                        @Html.ValidationMessageFor(x => x.fileFotoLacre)
                    </div>
                    <div class="mb-4">
                        <label asp-for="fileFotoPlaca" class="block mb-2 text-sm font-bold flex items-center"></label>
                        <input asp-for="fileFotoPlaca" accept="image/*" />
                        @Html.ValidationMessageFor(x => x.fileFotoPlaca)
                    </div>
                    <div class="mb-4">
                        <label asp-for="filesFotosAntes" class="block mb-2 text-sm font-bold flex items-center"></label>
                        <input asp-for="filesFotosAntes" accept="image/*" />
                        <input asp-for="filesFotosAntes" accept="image/*" />
                        <input asp-for="filesFotosAntes" accept="image/*" />
                        @Html.ValidationMessageFor(x => x.filesFotosAntes)
                    </div>
                    <div class="mb-4">
                        <label asp-for="filesFotosDepois" class="block mb-2 text-sm font-bold flex items-center"></label>
                        <input asp-for="filesFotosDepois" accept="image/*" />
                        <input asp-for="filesFotosDepois" accept="image/*" />
                        <input asp-for="filesFotosDepois" accept="image/*" />
                        @Html.ValidationMessageFor(x => x.filesFotosDepois)
                    </div>
                    <div class="mb-6 text-center">
                        <input type="submit" value="Registrar" class="w-full px-4 py-4 font-bold text-white bg-gradient-to-r from-yellow-300 to-amber-500 rounded-full hover:bg-gradient-to-r hover:from-amber-300 hover:to-yellow-500 rounded-full hover:cursor-pointer focus:outline-none focus:shadow-outline" />
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
    function verificarFotos() {
        var fotosAntes = document.querySelectorAll('input[name="filesFotosAntes"]');
        var fotosDepois = document.querySelectorAll('input[name="filesFotosDepois"]');

        var todasFotosAntes = Array.from(fotosAntes).every(function (input) {
            return input.files.length > 0;
        });

        var todasFotosDepois = Array.from(fotosDepois).every(function (input) {
            return input.files.length > 0;
        });

        if (!todasFotosAntes) {
            alert("Por favor, insira 3 fotos antes do carregamento.");
            return false;
        }

        if (!todasFotosDepois) {
            alert("Por favor, insira 3 fotos depois do carregamento.");
            return false;
        }

        return true;
    }

    document.getElementById('formTransporteMercadoria').addEventListener('submit', function (event) {
        if (!verificarFotos()) {
            event.preventDefault();
        }
    });
</script>

@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
}
